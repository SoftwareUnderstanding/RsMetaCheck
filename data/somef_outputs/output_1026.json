{"somef_provenance": {"somef_version": "0.9.12", "somef_schema_version": "1.0.0", "date": "2025-11-17 15:42:19"}, "code_repository": [{"result": {"value": "https://github.com/helske/bssm", "type": "Url"}, "confidence": 1, "technique": "GitHub_API"}, {"result": {"value": "https://github.com/helske/bssm", "type": "Url"}, "confidence": 1, "technique": "code_parser", "source": "https://raw.githubusercontent.com/helske/bssm/main/DESCRIPTION"}, {"result": {"value": "https://github.com/helske/bssm", "type": "Url"}, "confidence": 1, "technique": "code_parser", "source": "https://raw.githubusercontent.com/helske/bssm/main/codemeta.json"}], "owner": [{"result": {"value": "helske", "type": "User"}, "confidence": 1, "technique": "GitHub_API"}], "date_created": [{"result": {"value": "2016-03-11T19:36:44Z", "type": "Date"}, "confidence": 1, "technique": "GitHub_API"}], "date_updated": [{"result": {"value": "2025-11-17T14:23:44Z", "type": "Date"}, "confidence": 1, "technique": "GitHub_API"}], "description": [{"result": {"value": "Bayesian Inference of State Space Models", "type": "String"}, "confidence": 1, "technique": "GitHub_API"}, {"result": {"value": "Efficient methods for Bayesian inference of state space models \n    via Markov chain Monte Carlo (MCMC) based on parallel \n    importance sampling type weighted estimators \n    (Vihola, Helske, and Franks, 2020, <doi:10.1111/sjos.12492>), \n    particle MCMC, and its delayed acceptance version. \n    Gaussian, Poisson, binomial, negative binomial, and Gamma\n    observation densities and basic stochastic volatility models \n    with linear-Gaussian state dynamics, as well as general non-linear Gaussian \n    models and discretised diffusion models are supported. \n    See Helske and Vihola (2021, <doi:10.32614/RJ-2021-103>) for details.", "type": "String", "source": "https://raw.githubusercontent.com/helske/bssm/main/DESCRIPTION"}, "confidence": 1, "technique": "code_parser", "source": "https://raw.githubusercontent.com/helske/bssm/main/DESCRIPTION"}, {"result": {"value": "Efficient methods for Bayesian inference of state space models via Markov chain Monte Carlo (MCMC) based on parallel importance sampling type weighted estimators (Vihola, Helske, and Franks, 2020, <doi:10.1111/sjos.12492>), particle MCMC, and its delayed acceptance version. Gaussian, Poisson, binomial, negative binomial, and Gamma observation densities and basic stochastic volatility models with linear-Gaussian state dynamics, as well as general non-linear Gaussian models and discretised diffusion models are supported. See Helske and Vihola (2021, <doi:10.32614/RJ-2021-103>) for details.", "type": "String"}, "confidence": 1, "technique": "code_parser", "source": "https://raw.githubusercontent.com/helske/bssm/main/codemeta.json"}, {"result": {"type": "Text_excerpt", "value": "The `bssm` R package provides efficient methods for Bayesian inference\nof state space models via particle Markov chain Monte Carlo and\nimportance sampling type weighted MCMC. Currently Gaussian, Poisson,\nbinomial, negative binomial, and Gamma observation densities with\nlinear-Gaussian state dynamics, as well as general non-linear Gaussian\nmodels and discretely observed latent diffusion processes are supported. \nThere are also couple posters and a talk related to IS-correction\nmethodology and bssm package: \nThe `bssm` package was originally developed with the support of Academy\nof Finland grants 284513, 312605, 311877, and 331817. Current\ndevelopment is focused on increased usability. For recent changes, see\nNEWS file.\n \n", "original_header": "bssm"}, "confidence": 0.9109782733534039, "technique": "supervised_classification", "source": "https://raw.githubusercontent.com/helske/bssm/main/README.Rmd"}], "name": [{"result": {"value": "bssm", "type": "String"}, "confidence": 1, "technique": "GitHub_API"}, {"result": {"value": "bssm: Bayesian Inference of Non-Linear and Non-Gaussian State Space\n        Models", "type": "String"}, "confidence": 1, "technique": "code_parser", "source": "https://raw.githubusercontent.com/helske/bssm/main/codemeta.json"}], "full_name": [{"result": {"value": "helske/bssm", "type": "String"}, "confidence": 1, "technique": "GitHub_API"}], "issue_tracker": [{"result": {"value": "https://api.github.com/repos/helske/bssm/issues", "type": "Url"}, "confidence": 1, "technique": "GitHub_API"}, {"result": {"value": "https://github.com/helske/bssm/issues", "type": "Url"}, "confidence": 1, "technique": "code_parser", "source": "https://raw.githubusercontent.com/helske/bssm/main/DESCRIPTION"}, {"result": {"value": "https://github.com/helske/bssm/issues", "type": "Url"}, "confidence": 1, "technique": "code_parser", "source": "https://raw.githubusercontent.com/helske/bssm/main/codemeta.json"}], "forks_url": [{"result": {"value": "https://api.github.com/repos/helske/bssm/forks", "type": "Url"}, "confidence": 1, "technique": "GitHub_API"}], "stargazers_count": [{"result": {"value": 47, "type": "Number"}, "confidence": 1, "technique": "GitHub_API"}], "keywords": [{"result": {"value": "bayesian-inference, cpp, markov-chain-monte-carlo, particle-filter, r, state-space, time-series", "type": "String"}, "confidence": 1, "technique": "GitHub_API"}, {"result": {"value": ["bayesian-inference", "markov-chain-monte-carlo", "particle-filter", "time-series", "state-space", "r", "cpp"], "type": "String"}, "confidence": 1, "technique": "code_parser", "source": "https://raw.githubusercontent.com/helske/bssm/main/codemeta.json"}], "forks_count": [{"result": {"value": 14, "type": "Number"}, "confidence": 1, "technique": "GitHub_API"}], "download_url": [{"result": {"value": "https://github.com/helske/bssm/releases", "type": "Url"}, "confidence": 1, "technique": "GitHub_API"}], "programming_languages": [{"result": {"value": "HTML", "name": "HTML", "type": "Programming_language", "size": 756018}, "confidence": 1, "technique": "GitHub_API"}, {"result": {"value": "C++", "name": "C++", "type": "Programming_language", "size": 554554}, "confidence": 1, "technique": "GitHub_API"}, {"result": {"value": "R", "name": "R", "type": "Programming_language", "size": 363865}, "confidence": 1, "technique": "GitHub_API"}, {"result": {"value": "TeX", "name": "TeX", "type": "Programming_language", "size": 16903}, "confidence": 1, "technique": "GitHub_API"}, {"result": {"value": "C", "name": "C", "type": "Programming_language", "size": 4085}, "confidence": 1, "technique": "GitHub_API"}, {"result": {"name": "R", "value": "R", "type": "Programming_language", "url": "https://r-project.org"}, "confidence": 1, "technique": "code_parser", "source": "https://raw.githubusercontent.com/helske/bssm/main/codemeta.json"}], "releases": [{"result": {"type": "Release", "value": "https://api.github.com/repos/helske/bssm/releases/71368720", "tag": "v.2.0.1.3", "name": "v.2.0.1.3", "author": {"name": "helske", "type": "User"}, "description": "Forgot to create a release for 2.0.1, so this is it plus some additional changes based on the rOpenSci review which will be incorporated into the CRAN version 2.0.2 later. From the NEWS:\r\n\r\nbssm 2.0.1.3\r\n==============\r\n   * Switched to markdown NEWS with a plan to be more clear about the future\r\n     changes in the package.\r\n   * Added more details to the `?bssm` help page.\r\n   * Added more details to the `?bssm_prior` help page.\r\n   * Added option to extract only hyperparameters in `as_draws` method. Also\r\n     fixed a but in `as_draws` which caused the it to ignore `states` argument.\r\n   * Added a default plot method for the `run_mcmc` output.\r\n\r\nbssm 2.0.1 (Release date: 2022-05-02)\r\n==============\r\n   * Fixed weights to one in case of non-linear model with mcmc_type=\"approx\".\r\n   * Adjusted tolerance of some testthat tests to comply with CRAN's MKL checks.", "tarball_url": "https://api.github.com/repos/helske/bssm/tarball/v.2.0.1.3", "zipball_url": "https://api.github.com/repos/helske/bssm/zipball/v.2.0.1.3", "html_url": "https://github.com/helske/bssm/releases/tag/v.2.0.1.3", "url": "https://api.github.com/repos/helske/bssm/releases/71368720", "release_id": 71368720, "date_created": "2022-07-06T10:20:30Z", "date_published": "2022-07-06T13:04:59Z", "assets": [{"url": "https://api.github.com/repos/helske/bssm/releases/assets/70737029", "name": "bssm_2.0.1.3.tar.gz", "content_size": 2487315, "content_url": "https://github.com/helske/bssm/releases/download/v.2.0.1.3/bssm_2.0.1.3.tar.gz", "encoding_format": "application/x-gzip", "upload_date": "2022-07-06T13:04:08Z", "download_count": 9}]}, "confidence": 1, "technique": "GitHub_API"}, {"result": {"type": "Release", "value": "https://api.github.com/repos/helske/bssm/releases/54522216", "tag": "v.2.0.0", "name": "CRAN version 2.0.0", "author": {"name": "helske", "type": "User"}, "description": "Bump to version 2.0.0 due to large number of changes, some visible to user, while some are due to submission to rOpenSci review. From the NEWS file:\r\n\r\n   * Added a progress bar for run_mcmc.\r\n   * Added a fitted method for extraction of summary statistics of posterior \r\n     predictive distribution p(y_t | y_1, ..., y_n) for t = 1, ..., n. \r\n   * Rewrote the summary method completely, which now returns data.frame. This \r\n     also resulted in some changes in order of the function arguments.\r\n   * The output of predict method is now a data frame with column weight \r\n     corresponding to the IS-weights in case of IS-MCMC. Previously resampling \r\n     was done internally, but now this is left for the user if needed \r\n     (i.e. for drawing state trajectories).\r\n   * The asymptotic_var and iact functions are now exported to users, and they \r\n     also contain alternative methods based on the posterior package.\r\n   * New function estimate_ess can be used to compute effective sample size \r\n     from weighted MCMC.\r\n   * Added compatibility with the posterior package by defining as_draws \r\n     method for converting run_mcmc output to draws_df object.\r\n   * New function check_diagnostics for quick glance of ESS and Rhat values.\r\n   * Large number of new tests, and improved documentation with added examples.\r\n   * Large number of internal tweaks so that the package complies with \r\n     goodpractices package and Ropensci statistical software standards.", "tarball_url": "https://api.github.com/repos/helske/bssm/tarball/v.2.0.0", "zipball_url": "https://api.github.com/repos/helske/bssm/zipball/v.2.0.0", "html_url": "https://github.com/helske/bssm/releases/tag/v.2.0.0", "url": "https://api.github.com/repos/helske/bssm/releases/54522216", "release_id": 54522216, "date_created": "2021-11-26T09:39:40Z", "date_published": "2021-12-02T18:27:15Z", "assets": []}, "confidence": 1, "technique": "GitHub_API"}, {"result": {"type": "Release", "value": "https://api.github.com/repos/helske/bssm/releases/49938939", "tag": "v1.1.7-1", "name": "CRAN release 1.1.7-1", "author": {"name": "helske", "type": "User"}, "description": "New CRAN version with mostly internal tweaking and more examples:\r\n\r\nbssm 1.1.7-1 (Release date: 2021-09-21)\r\n==============\r\n   * Fixed an error in automatic tests due to lack of fixed RNG seed.\r\n\r\nbssm 1.1.7 (Release date: 2021-09-20)\r\n==============\r\n   * Added a function cpp_example_model which can be used to extract and \r\n     compile some non-linear and SDE models used in the examples and vignettes.\r\n   * Added as_draws method for run_mcmc output so samples can be analysed using \r\n     the posterior package.\r\n   * Added more examples.\r\n   * Fixed a tolerance of one MCMC test to pass the test on OSX as well.\r\n   * Fixed a bug in iterated extended Kalman smoothing which resulted incorrect \r\n     estimates.", "tarball_url": "https://api.github.com/repos/helske/bssm/tarball/v1.1.7-1", "zipball_url": "https://api.github.com/repos/helske/bssm/zipball/v1.1.7-1", "html_url": "https://github.com/helske/bssm/releases/tag/v1.1.7-1", "url": "https://api.github.com/repos/helske/bssm/releases/49938939", "release_id": 49938939, "date_created": "2021-09-20T10:23:47Z", "date_published": "2021-09-20T20:24:45Z", "assets": []}, "confidence": 1, "technique": "GitHub_API"}, {"result": {"type": "Release", "value": "https://api.github.com/repos/helske/bssm/releases/49051795", "tag": "v1.1.6", "name": "CRAN version 1.1.6", "author": {"name": "helske", "type": "User"}, "description": "Added a large number of automatic tests which resulted in finding and fixing some bugs, most notably in the case of non-linear models and the predict method (See NEWS for details). ", "tarball_url": "https://api.github.com/repos/helske/bssm/tarball/v1.1.6", "zipball_url": "https://api.github.com/repos/helske/bssm/zipball/v1.1.6", "html_url": "https://github.com/helske/bssm/releases/tag/v1.1.6", "url": "https://api.github.com/repos/helske/bssm/releases/49051795", "release_id": 49051795, "date_created": "2021-09-05T15:21:58Z", "date_published": "2021-09-06T07:10:28Z", "assets": []}, "confidence": 1, "technique": "GitHub_API"}, {"result": {"type": "Release", "value": "https://api.github.com/repos/helske/bssm/releases/45989341", "tag": "v1.1.5", "name": "CRAN version 1.1.5", "author": {"name": "helske", "type": "User"}, "description": "Small update, updated drownings data until 2019 and made few small internal argument checks.", "tarball_url": "https://api.github.com/repos/helske/bssm/tarball/v1.1.5", "zipball_url": "https://api.github.com/repos/helske/bssm/zipball/v1.1.5", "html_url": "https://github.com/helske/bssm/releases/tag/v1.1.5", "url": "https://api.github.com/repos/helske/bssm/releases/45989341", "release_id": 45989341, "date_created": "2021-07-09T21:09:09Z", "date_published": "2021-07-09T21:15:46Z", "assets": []}, "confidence": 1, "technique": "GitHub_API"}, {"result": {"type": "Release", "value": "https://api.github.com/repos/helske/bssm/releases/45966379", "tag": "v1.1.4", "name": "CRAN version 1.1.4", "author": {"name": "helske", "type": "User"}, "description": "CRAN version 1.1.4. Changes from NEWS file:\r\n\r\nbssm 1.1.4 (Release date: 2021-04-13)\r\n==============\r\n   * Better documentation for SV model, and changed the ordering of arguments to emphasise the recommended parameterization.\r\n   * Fixed predict method for SV model.\r\n   * Removed parallelization in one example which failed on Solaris for some unknown reason.", "tarball_url": "https://api.github.com/repos/helske/bssm/tarball/v1.1.4", "zipball_url": "https://api.github.com/repos/helske/bssm/zipball/v1.1.4", "html_url": "https://github.com/helske/bssm/releases/tag/v1.1.4", "url": "https://api.github.com/repos/helske/bssm/releases/45966379", "release_id": 45966379, "date_created": "2021-04-13T13:50:03Z", "date_published": "2021-07-09T12:48:15Z", "assets": []}, "confidence": 1, "technique": "GitHub_API"}, {"result": {"type": "Release", "value": "https://api.github.com/repos/helske/bssm/releases/6337526", "tag": "v0.0.75", "name": "First release", "author": {"name": "helske", "type": "User"}, "description": "First properly documented release after introducing the non-linear Gaussian models. Some features which were available before rebuilding are still missing, but main features should fully working.", "tarball_url": "https://api.github.com/repos/helske/bssm/tarball/v0.0.75", "zipball_url": "https://api.github.com/repos/helske/bssm/zipball/v0.0.75", "html_url": "https://github.com/helske/bssm/releases/tag/v0.0.75", "url": "https://api.github.com/repos/helske/bssm/releases/6337526", "release_id": 6337526, "date_created": "2017-05-10T10:16:53Z", "date_published": "2017-05-10T11:29:34Z", "assets": [{"url": "https://api.github.com/repos/helske/bssm/releases/assets/3841881", "name": "bssm_0.0.75.tar.gz", "content_size": 487154, "content_url": "https://github.com/helske/bssm/releases/download/v0.0.75/bssm_0.0.75.tar.gz", "encoding_format": "application/gzip", "upload_date": "2017-05-10T11:29:30Z", "download_count": 11}]}, "confidence": 1, "technique": "GitHub_API"}], "readme_url": [{"result": {"value": "https://raw.githubusercontent.com/helske/bssm/main/README.Rmd", "type": "Url"}, "confidence": 1, "technique": "file_exploration"}, {"result": {"value": "https://github.com/helske/bssm/blob/main/README.md", "type": "String"}, "confidence": 1, "technique": "code_parser", "source": "https://raw.githubusercontent.com/helske/bssm/main/codemeta.json"}, {"result": {"value": "https://raw.githubusercontent.com/helske/bssm/main/README.md", "type": "Url"}, "confidence": 1, "technique": "file_exploration"}], "has_build_file": [{"result": {"value": "https://raw.githubusercontent.com/helske/bssm/main/DESCRIPTION", "type": "Url", "format": "description"}, "confidence": 1, "technique": "file_exploration", "source": "https://raw.githubusercontent.com/helske/bssm/main/DESCRIPTION"}], "has_package_file": [{"result": {"value": "DESCRIPTION", "type": "Url", "source": "https://raw.githubusercontent.com/helske/bssm/main/DESCRIPTION"}, "confidence": 1, "technique": "code_parser", "source": "https://raw.githubusercontent.com/helske/bssm/main/DESCRIPTION"}], "package_id": [{"result": {"value": "bssm", "type": "String", "source": "https://raw.githubusercontent.com/helske/bssm/main/DESCRIPTION"}, "confidence": 1, "technique": "code_parser", "source": "https://raw.githubusercontent.com/helske/bssm/main/DESCRIPTION"}], "version": [{"result": {"value": "2.0.3", "type": "String", "source": "https://raw.githubusercontent.com/helske/bssm/main/DESCRIPTION"}, "confidence": 1, "technique": "code_parser", "source": "https://raw.githubusercontent.com/helske/bssm/main/DESCRIPTION"}, {"result": {"value": "2.0.2", "type": "String"}, "confidence": 1, "technique": "code_parser", "source": "https://raw.githubusercontent.com/helske/bssm/main/codemeta.json"}], "license": [{"result": {"value": "GPL (>= 2)", "type": "String", "source": "https://raw.githubusercontent.com/helske/bssm/main/DESCRIPTION"}, "confidence": 1, "technique": "code_parser", "source": "https://raw.githubusercontent.com/helske/bssm/main/DESCRIPTION"}, {"result": {"value": "https://spdx.org/licenses/GPL-2.0", "type": "License", "identifier": "https://spdx.org/licenses/https://spdx.org/licenses/GPL-2.0", "spdx_id": "https://spdx.org/licenses/GPL-2.0"}, "confidence": 1, "technique": "code_parser", "source": "https://raw.githubusercontent.com/helske/bssm/main/codemeta.json"}], "continuous_integration": [{"result": {"value": ["https://github.com/helske/bssm/actions", "https://app.codecov.io/gh/helske/bssm?branch=master"], "type": "Url"}, "confidence": 1, "technique": "code_parser", "source": "https://raw.githubusercontent.com/helske/bssm/main/codemeta.json"}], "development_status": [{"result": {"value": "https://www.repostatus.org/#active", "type": "String"}, "confidence": 1, "technique": "code_parser", "source": "https://raw.githubusercontent.com/helske/bssm/main/codemeta.json"}], "identifier": [{"result": {"value": "bssm", "type": "String"}, "confidence": 1, "technique": "code_parser", "source": "https://raw.githubusercontent.com/helske/bssm/main/codemeta.json"}], "authors": [{"result": {"value": "Jouni Helske", "type": "String", "email": "jouni.helske@iki.fi", "identifier": "https://orcid.org/0000-0001-7130-793X"}, "confidence": 1, "technique": "code_parser", "source": "https://raw.githubusercontent.com/helske/bssm/main/codemeta.json"}, {"result": {"value": "Matti Vihola", "type": "String", "identifier": "https://orcid.org/0000-0002-8041-7222"}, "confidence": 1, "technique": "code_parser", "source": "https://raw.githubusercontent.com/helske/bssm/main/codemeta.json"}], "citation": [{"result": {"value": "c(\n  bibentry(\n     bibtype = \"Article\",\n     key = \"helske-vihola2021\",\n     title = \"bssm: Bayesian Inference of Non-linear and Non-Gaussian State Space Models in {R}\",\n     author =\" Jouni Helske and Matti Vihola\",\n     year= \"2021\",\n     doi = \"10.32614/RJ-2021-103\",\n     journal = \"R Journal\",\n     url = \"https://doi.org/10.32614/RJ-2021-103\",\n     pages = \"578--589\",\n     volume = \"13\",\n     number = \"2\"\n  ),\n  bibentry(\n    bibtype = \"Article\",\n    author = \"Matti Vihola, Jouni Helske, and Jordan Franks\",\n    title = \"Importance Sampling Type Estimators Based on Approximate Marginal {MCMC}\",\n    journal = \"Scandinavian Journal of Statistics\",\n    doi = \"10.1111/sjos.12492\",\n    url = \"https://onlinelibrary.wiley.com/doi/abs/10.1111/sjos.12492\",\n    year = \"2020\",\n    key = \"vihola-helske-franks\"\n  )\n)\n", "type": "File_dump", "format": "bibtex", "datePublished": "2021"}, "confidence": 1, "technique": "file_exploration", "source": "https://raw.githubusercontent.com/helske/bssm/main/inst/CITATION"}, {"result": {"value": "If you use the `bssm` package in publications, please cite the\ncorresponding R Journal paper:\n\nJouni Helske and Matti Vihola (2021). \u201cbssm: Bayesian Inference of\nNon-linear and Non-Gaussian State Space Models in R.\u201d The R Journal\n(2021) 13:2, pages 578-589.\n<https://journal.r-project.org/archive/2021/RJ-2021-103/index.html>\n", "type": "Text_excerpt", "original_header": "Citing the package", "parent_header": ["bssm"]}, "confidence": 1, "technique": "header_analysis", "source": "https://raw.githubusercontent.com/helske/bssm/main/README.Rmd"}], "contributing_guidelines": [{"result": {"value": "# CONTRIBUTING #\n\n### Fixing typos\n\nSmall typos or grammatical errors in documentation may be edited directly using\nthe GitHub web interface, so long as the changes are made in the _source_ file.\n\n*  YES: you edit a roxygen comment in a `.R` file below `R/`.\n*  NO: you edit an `.Rd` file below `man/`.\n\n### Prerequisites\n\nBefore you make a substantial pull request, you should always file an issue and\nmake sure someone from the team agrees that it\u2019s a problem. If you\u2019ve found a\nbug, create an associated issue and illustrate the bug with a minimal \n[reprex](https://www.tidyverse.org/help/#reprex).\n\n### Pull request process\n\n*  We recommend that you create a Git branch for each pull request (PR).  \n*  Look at the Github Actions build status before and after making changes.\nThe `README` should contain status badge \"R-CMD-check\" which acts a link to \nGithub Actions.  \n*  We recommend the tidyverse [style guide](http://style.tidyverse.org).\nYou can use the [styler](https://CRAN.R-project.org/package=styler) package to\napply these styles, but please don't restyle code that has nothing to do with \nyour PR.  \n*  We use [roxygen2](https://cran.r-project.org/package=roxygen2).  \n*  We use [testthat](https://cran.r-project.org/package=testthat).\nContributions with test cases included are easier to accept.  \n*  For user-facing changes, add a bullet to the top of `NEWS.md` below the\ncurrent development version header describing the changes made followed by your\nGitHub username, and links to relevant issue(s)/PR(s).\n\n### Thanks for contributing!\n\nThis contributing guide is adapted from the tidyverse contributing guide available at https://raw.githubusercontent.com/r-lib/usethis/master/inst/templates/tidy-contributing.md\n", "type": "File_dump"}, "confidence": 1, "technique": "file_exploration", "source": "https://raw.githubusercontent.com/helske/bssm/main/.github/CONTRIBUTING.md"}], "installation": [{"result": {"value": "You can install the released version of bssm from\n[CRAN](https://CRAN.R-project.org) with:\n\n``` r\ninstall.packages(\"bssm\")\n```\n\nAnd the development version from [GitHub](https://github.com/) with:\n\n``` r\n# install.packages(\"devtools\")\ndevtools::install_github(\"helske/bssm\")\n```\n\nOr from R-universe with\n\n``` r\ninstall.packages(\"bssm\", repos = \"https://helske.r-universe.dev\")\n```\n", "type": "Text_excerpt", "original_header": "Installation", "parent_header": ["bssm"]}, "confidence": 1, "technique": "header_analysis", "source": "https://raw.githubusercontent.com/helske/bssm/main/README.Rmd"}], "usage": [{"result": {"value": "Consider the daily air quality measurements in New Your from May to\nSeptember 1973, available in the `datasets` package. Let\u2019s try to\npredict the missing ozone levels by simple linear-Gaussian local linear\ntrend model with temperature and wind as explanatory variables (missing\nresponse variables are handled naturally in the state space modelling\nframework, however no missing values in covariates are normally\nallowed);\n\n``` r\nlibrary(\"bssm\")\n#> Warning: package 'bssm' was built under R version 4.3.1\n#> \n#> Attaching package: 'bssm'\n#> The following object is masked from 'package:base':\n#> \n#>     gamma\nlibrary(\"dplyr\")\n#> \n#> Attaching package: 'dplyr'\n#> The following objects are masked from 'package:stats':\n#> \n#>     filter, lag\n#> The following objects are masked from 'package:base':\n#> \n#>     intersect, setdiff, setequal, union\nlibrary(\"ggplot2\")\n#> Warning: package 'ggplot2' was built under R version 4.3.1\nset.seed(1)\n\ndata(\"airquality\", package = \"datasets\")\n\n# Covariates as matrix. For complex cases, check out as_bssm function\nxreg <- airquality |> select(Wind, Temp) |> as.matrix()\n\nmodel <- bsm_lg(airquality$Ozone,\n  xreg = xreg,  \n  # Define priors for hyperparameters (i.e. not the states), see ?bssm_prior\n  # Initial value followed by parameters of the prior distribution\n  beta = normal_prior(rep(0, ncol(xreg)), 0, 1),\n  sd_y = gamma_prior(1, 2, 0.01),\n  sd_level = gamma_prior(1, 2, 0.01), \n  sd_slope = gamma_prior(1, 2, 0.01))\n\nfit <- run_mcmc(model, iter = 20000, burnin = 5000)\nfit\n#> \n#> Call:\n#> run_mcmc.lineargaussian(model = model, iter = 20000, burnin = 5000)\n#> \n#> Iterations = 5001:20000\n#> Thinning interval = 1\n#> Length of the final jump chain = 3593\n#> \n#> Acceptance rate after the burn-in period:  0.239\n#> \n#> Summary for theta:\n#> \n#>  variable       Mean          SE        SD        2.5%     97.5% ESS\n#>      Temp  1.0265846 0.007497538 0.2064343  0.60226671  1.400436 758\n#>      Wind -2.5183269 0.020978488 0.5764833 -3.68987992 -1.327578 755\n#>  sd_level  6.3731836 0.113153715 2.8013937  1.52958636 12.403961 613\n#>  sd_slope  0.3388712 0.010355574 0.2833955  0.04210885  1.070284 749\n#>      sd_y 20.8618647 0.068145131 1.9369381 17.08728231 24.722309 808\n#> \n#> Summary for alpha_154:\n#> \n#>  variable time        Mean         SE        SD       2.5%     97.5%  ESS\n#>     level  154 -28.3163054 0.69650977 20.132341 -69.271049 11.797133  835\n#>     slope  154  -0.3740463 0.03683278  1.685733  -4.065499  2.830134 2094\n#> \n#> Run time:\n#>    user  system elapsed \n#>    0.57    0.02    0.63\n\nobs <- data.frame(Time = 1:nrow(airquality),\n  Ozone = airquality$Ozone) |> filter(!is.na(Ozone))\n\npred <- fitted(fit, model)\npred |>\n  ggplot(aes(x = Time, y = Mean)) + \n  geom_ribbon(aes(ymin = `2.5%`, ymax = `97.5%`), \n    alpha = 0.5, fill = \"steelblue\") + \n  geom_line() + \n  geom_point(data = obs, \n    aes(x = Time, y = Ozone), colour = \"Tomato\") +\n  theme_bw()\n```\n\n<img src=\"man/figures/README-example-1.png\" width=\"100%\" />\n\nSame model but now assuming observations are from Gamma distribution:\n\n``` r\n\nmodel2 <- bsm_ng(airquality$Ozone,\n  xreg = xreg,  \n  beta = normal(rep(0, ncol(xreg)), 0, 1),\n  distribution = \"gamma\",\n  phi = gamma_prior(1, 2, 0.01),\n  sd_level = gamma_prior(1, 2, 0.1), \n  sd_slope = gamma_prior(1, 2, 0.1))\n\nfit2 <- run_mcmc(model2, iter = 20000, burnin = 5000, particles = 10)\nfit2\n#> \n#> Call:\n#> run_mcmc.nongaussian(model = model2, iter = 20000, particles = 10, \n#>     burnin = 5000)\n#> \n#> Iterations = 5001:20000\n#> Thinning interval = 1\n#> Length of the final jump chain = 3858\n#> \n#> Acceptance rate after the burn-in period:  0.257\n#> \n#> Summary for theta:\n#> \n#>  variable         Mean           SE          SD          2.5%       97.5%  ESS\n#>      Temp  0.052808820 0.0002404538 0.008701489  0.0353736458  0.06992423 1310\n#>      Wind -0.057351094 0.0004338213 0.015411504 -0.0873384757 -0.02700112 1262\n#>       phi  4.006977632 0.0159088062 0.536273508  3.0263444882  5.15527365 1136\n#>  sd_level  0.057158663 0.0020138200 0.035366227  0.0083794202  0.14651419  308\n#>  sd_slope  0.003894013 0.0001752319 0.003654978  0.0004250207  0.01374575  435\n#>         SE_IS ESS_IS\n#>  7.128104e-05  14485\n#>  1.263047e-04  13905\n#>  4.411840e-03  14611\n#>  2.927386e-04  10591\n#>  3.031489e-05   7766\n#> \n#> Summary for alpha_154:\n#> \n#>  variable time         Mean           SE         SD        2.5%      97.5%  ESS\n#>     level  154 -0.200656509 0.0201721601 0.73134471 -1.62501396 1.24522802 1314\n#>     slope  154 -0.002689176 0.0005121944 0.02289051 -0.04650504 0.04724173 1997\n#>        SE_IS ESS_IS\n#>  0.005987284   9458\n#>  0.000191620   6448\n#> \n#> Run time:\n#>    user  system elapsed \n#>    7.50    0.01    7.71\n```\n\nComparison:\n\n``` r\npred2 <- fitted(fit2, model2)\n\nbind_rows(list(Gaussian = pred, Gamma = pred2), .id = \"Model\") |>\n  ggplot(aes(x = Time, y = Mean)) + \n  geom_ribbon(aes(ymin = `2.5%`, ymax = `97.5%`, fill = Model), \n    alpha = 0.25) + \n  geom_line(aes(colour = Model)) + \n  geom_point(data = obs, \n    aes(x = Time, y = Ozone)) +\n  theme_bw()\n```\n\n<img src=\"man/figures/README-compare-1.png\" width=\"100%\" />\n\nNow let\u2019s assume that we also want to use the solar radiation variable\nas predictor for ozone. As it contains few missing values, we cannot use\nit directly. As the number of missing time points is very small, simple\nimputation would likely be acceptable, but let\u2019s consider more another\napproach. For simplicity, the slope terms of the previous models are now\nomitted, and we focus on the Gaussian case. Let $\\mu_t$ be the true\nsolar radiation at time $t$. Now for ozone $O_t$ we assume following\nmodel:\n\n$O_t = D_t + \\alpha_t + \\beta_S \\mu_t + \\sigma_\\epsilon \\epsilon_t$  \n$\\alpha_{t+1} = \\alpha_t + \\sigma_\\eta\\eta_t$  \n$\\alpha_1 \\sim N(0, 100^2\\textrm{I})$,  \nwheere $D_t = \\beta X_t$ contains regression terms related to wind and\ntemperature, $\\alpha_t$ is the time varying intercept term, and\n$\\beta_S$ is the effect of solar radiation $\\mu_t$.\n\nNow for the observed solar radiation $S_t$ we assume\n\n$S_t = \\mu_t$  \n$\\mu_{t+1} = \\mu_t + \\sigma_\\xi\\xi_t,$  \n$\\mu_1 \\sim N(0, 100^2)$,  \ni.e.\u00a0we assume as simple random walk for the $\\mu$ which we observe\nwithout error or not at all (there is no error term in the observation\nequation $S_t=\\mu_t$).\n\nWe combine these two models as a bivariate Gaussian model with\n`ssm_mlg`:\n\n``` r\n# predictors (not including solar radiation) for ozone\nxreg <- airquality |> select(Wind, Temp) |> as.matrix()\n\n# Function which outputs new model components given the parameter vector theta\nupdate_fn <- function(theta) {\n  D <- rbind(t(xreg %*% theta[1:2]), 1)\n  Z <- matrix(c(1, 0, theta[3], 1), 2, 2)\n  R <- diag(exp(theta[4:5]))\n  H <- diag(c(exp(theta[6]), 0))\n  # add third dimension so we have p x n x 1, p x m x 1, p x p x 1 arrays\n  dim(Z)[3] <- dim(R)[3] <- dim(H)[3] <- 1\n  list(D = D, Z = Z, R = R, H = H)\n}\n\n# Function for log-prior density\nprior_fn <- function(theta) {\n  sum(dnorm(theta[1:3], 0, 10, log = TRUE)) + \n    sum(dgamma(exp(theta[4:6]), 2, 0.01, log = TRUE)) + \n    sum(theta[4:6]) # log-jacobian\n}\n\ninit_theta <- c(0, 0, 0, log(50), log(5), log(20))\ncomps <- update_fn(init_theta)\n\nmodel <- ssm_mlg(y = cbind(Ozone = airquality$Ozone, Solar = airquality$Solar.R),\n  Z = comps$Z, D = comps$D, H = comps$H, T = diag(2), R = comps$R, \n  a1 = rep(0, 2), P1 = diag(100, 2), init_theta = init_theta, \n  state_names = c(\"alpha\", \"mu\"), update_fn = update_fn,\n  prior_fn = prior_fn)\n\nfit <- run_mcmc(model, iter = 60000, burnin = 10000)\nfit\n#> \n#> Call:\n#> run_mcmc.lineargaussian(model = model, iter = 60000, burnin = 10000)\n#> \n#> Iterations = 10001:60000\n#> Thinning interval = 1\n#> Length of the final jump chain = 12234\n#> \n#> Acceptance rate after the burn-in period:  0.245\n#> \n#> Summary for theta:\n#> \n#>  variable        Mean           SE         SD       2.5%      97.5%  ESS\n#>   theta_1 -3.89121114 0.0233827004 0.58715113 -5.0085134 -2.6915137  631\n#>   theta_2  0.98712126 0.0051506907 0.18819758  0.5917823  1.3475147 1335\n#>   theta_3  0.06324657 0.0004672314 0.02417334  0.0141425  0.1100184 2677\n#>   theta_4  0.82577262 0.0165661049 0.67134723 -0.6840637  1.9160168 1642\n#>   theta_5  4.75567621 0.0010887250 0.05858454  4.6446809  4.8704036 2895\n#>   theta_6  3.05462451 0.0014803971 0.07640392  2.9032635  3.2028023 2664\n#> \n#> Summary for alpha_154:\n#> \n#>  variable time      Mean        SE        SD       2.5%     97.5%  ESS\n#>     alpha  154 -16.44435 0.3659912  14.99708 -46.321645  13.01863 1679\n#>        mu  154 223.60490 1.3409568 116.49063  -6.206301 453.18554 7546\n#> \n#> Run time:\n#>    user  system elapsed \n#>    7.41    0.11    7.83\n```\n\nDraw predictions:\n\n``` r\npred <- fitted(fit, model)\n\nobs <- data.frame(Time = 1:nrow(airquality),\n  Solar = airquality$Solar.R) |> filter(!is.na(Solar))\n\npred |> filter(Variable == \"Solar\") |>\n  ggplot(aes(x = Time, y = Mean)) + \n  geom_ribbon(aes(ymin = `2.5%`, ymax = `97.5%`), \n    alpha = 0.5, fill = \"steelblue\") + \n  geom_line() + \n  geom_point(data = obs, \n    aes(x = Time, y = Solar), colour = \"Tomato\") +\n  theme_bw()\n```\n\n<img src=\"man/figures/README-bivariate-fig-1.png\" width=\"100%\" />\n\n``` r\n\n\nobs <- data.frame(Time = 1:nrow(airquality),\n  Ozone = airquality$Ozone) |> filter(!is.na(Ozone))\n\npred |> filter(Variable == \"Ozone\") |>\n  ggplot(aes(x = Time, y = Mean)) + \n  geom_ribbon(aes(ymin = `2.5%`, ymax = `97.5%`), \n    alpha = 0.5, fill = \"steelblue\") + \n  geom_line() +  \n  geom_point(data = obs, \n    aes(x = Time, y = Ozone), colour = \"Tomato\") +\n  theme_bw()\n```\n\n<img src=\"man/figures/README-bivariate-fig-2.png\" width=\"100%\" />\n\nSee more examples in the paper, vignettes, and in the docs.", "type": "Text_excerpt", "original_header": "Example", "parent_header": ["bssm"]}, "confidence": 1, "technique": "header_analysis", "source": "https://raw.githubusercontent.com/helske/bssm/main/README.Rmd"}], "full_title": [{"result": {"type": "String", "value": "bssm"}, "confidence": 1, "technique": "regular_expression", "source": "https://raw.githubusercontent.com/helske/bssm/main/README.Rmd"}], "repository_status": [{"result": {"type": "Url", "value": "https://www.repostatus.org/#active", "description": "Active - The project has reached a stable, usable\nstate and is being actively\ndeveloped"}, "confidence": 1, "technique": "regular_expression", "source": "https://raw.githubusercontent.com/helske/bssm/main/README.Rmd"}], "images": [{"result": {"type": "Url", "value": "https://raw.githubusercontent.com/helske/bssm/main/man/figures/README-example-1.png"}, "confidence": 1, "technique": "regular_expression", "source": "https://raw.githubusercontent.com/helske/bssm/main/README.Rmd"}, {"result": {"type": "Url", "value": "https://raw.githubusercontent.com/helske/bssm/main/man/figures/README-compare-1.png"}, "confidence": 1, "technique": "regular_expression", "source": "https://raw.githubusercontent.com/helske/bssm/main/README.Rmd"}, {"result": {"type": "Url", "value": "https://raw.githubusercontent.com/helske/bssm/main/man/figures/README-bivariate-fig-1.png"}, "confidence": 1, "technique": "regular_expression", "source": "https://raw.githubusercontent.com/helske/bssm/main/README.Rmd"}, {"result": {"type": "Url", "value": "https://raw.githubusercontent.com/helske/bssm/main/man/figures/README-bivariate-fig-2.png"}, "confidence": 1, "technique": "regular_expression", "source": "https://raw.githubusercontent.com/helske/bssm/main/README.Rmd"}]}